<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WAR</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.8.2/firebase.js"></script>
    <style>
        #deck {
            width: 100%;
            margin: 20px auto;
            background: transparent;
            border: solid 10px black;
            outline-style: double;
            outline-color: tomato;
            outline-width: thick;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            color: white;
        }

        #deck2 {
            width: 100%;
            margin: 20px auto;
            background: transparent;
            border: solid 10px black;
            outline-style: double;
            outline-color: tomato;
            outline-width: thick;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            color: white;
        }

        .card {
            padding: 10px;
            border: solid 1px #808080;
            background-color: white;
            display: inline-block;
            border-radius: 10px;
            font-size: 10pt;
            text-align: left;
            color: black;
            margin: 3px;
        }


        #draw {
            background: black;
            color: red;
            padding: 10px 20px;
            border: solid whitesmoke;
            border-radius: 100%;
            margin: 10px;
            display: inline-block;
            cursor: pointer;
        }

        .card .suit {
            background-image: url('http://www.thatsoftwaredude.com/images/post/0f631eeb-6c4a-4bfd-9f86-e0a08ae8584b.png');
            height: 95px;
            width: 85px;
        }

        .card .diamonds {
            background-position-y: 95px;
            color: red;
            font-size: 15pt;
            font-weight: bold;
        }

        .card .hearts {
            background-position-x: 88px;
            color: red;
            font-size: 15pt;
            font-weight: bold;
        }

        .card .clubs {
            background-position-x: 89px;
            background-position-y: 100px;
            color: black;
            font-size: 15pt;
            font-weight: bold;
        }

        .card .spades {
            color: black;
            font-size: 15pt;
            font-weight: bold;
        }

        #jumbo {
            background: darkgreen;
        }

        #play-field {
            border: solid 10px black;
            border-radius: 10px;
            outline-style: double;
            outline-color: tomato;
            outline-width: thick;
            background: transparent;
        }

        h1 {
            color: yellow;
            text-shadow: 2px 2px whitesmoke;

        }

        @keyframes color-change {
            0% {
                color: red;
            }

            50% {
                color: dodgerblue;
            }

            100% {
                color: red;
            }

        }

        #whoWins {
            animation: color-change .5s infinite;
        }
    </style>

</head>

<body>
    <audio id="lewya" src="https://www.myinstants.com/media/sounds/hallelujahshort.swf.mp3"></audio>
    <audio id="loser" src="https://www.myinstants.com/media/sounds/the-simpsons-nelsons-haha_Hr8OgOG.mp3"></audio>
    <div id="jumbo" class="jumbotron jumbotron-fluid text-center">
        <div class="container">
            <div>
                <h1>War? What Is It Good For?</h1>
                <div id="play-field" class="jumbotron jumbotron-fluid text-center">
                    <div class="container">
                        <div class="hand">
                            <h1><span id="whoWins"></span></h1>
                            <h1> Your Wins: <span id="yourWins"></span> </h1>
                            <h1> CPU Wins: <span id="cpuWins"></span> </h1>
                            <div id="compare"></div>
                            <button id="draw" class="">
                                <h2> Draw </h2>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="deck" class="jumbotron jumbotron-fluid">

                </div>
                <div id="deck2" class="jumbotron jumbotron-fluid">

                </div>
            </div>
        </div>
    </div>




    <script>
        // Initialize Firebase
        var config = {
            apiKey: "AIzaSyCM_tKjM5bnm8Y4YYuT8ysLqEJz6nGZJ4M",
            authDomain: "cards-9bc89.firebaseapp.com",
            databaseURL: "https://cards-9bc89.firebaseio.com",
            projectId: "cards-9bc89",
            storageBucket: "",
            messagingSenderId: "476453356015"
        };

        firebase.initializeApp(config);
        var db = firebase.database();

        var deck = [];
        var deck2 = [];
        var suits = ["spades", "diamonds", "clubs", "hearts"];
        var values = ["2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14"];
        var compare = [];
        var yourWins = 0;
        var cpuWins = 0;

        function getDeck() {
            var deck = [];
            for (var i = 0; i < suits.length; i++) {
                for (var x = 0; x < values.length; x++) {
                    var card = { Value: values[x], Suit: suits[i] };
                    deck.push(card);
                }
            }

            return deck;
        }

        function getDeck2() {
            var deck2 = [];
            for (var i = 0; i < suits.length; i++) {
                for (var x = 0; x < values.length; x++) {
                    var card = { Value: values[x], Suit: suits[i] };
                    deck2.push(card);
                }
            }

            return deck2;
        }

        function renderDeck() {
            document.getElementById("deck").innerHTML = "";
            for (var i = 0; i < deck.length; i++) {
                var card = document.createElement("div");
                var value = document.createElement("div");
                var suit = document.createElement("div");
                card.className = "card " + "jumbotron " + "jumbotron-fluid";
                value.className = "value" + deck[i].Value + " " + deck[i].Suit;
                suit.className = "suit " + deck[i].Suit;
                value.innerHTML = deck[i].Value;
                card.appendChild(value);
                card.appendChild(suit);
                document.getElementById("deck").appendChild(card);
                $(".value11").text("J");
                $(".value12").text("Q");
                $(".value13").text("K");
                $(".value14").text("A");
            }
        }

        function renderDeck2() {
            document.getElementById("deck2").innerHTML = "";
            for (var i = 0; i < deck2.length; i++) {
                var card = document.createElement("div");
                var value = document.createElement("div");
                var suit = document.createElement("div");
                var value2 = document.createElement("div");
                card.className = "card";
                value.className = "value" + deck2[i].Value + " " + deck2[i].Suit;
                suit.className = "suit " + deck2[i].Suit;
                value.innerHTML = deck2[i].Value;
                card.appendChild(value);
                card.appendChild(suit);
                document.getElementById("deck2").appendChild(card);
                $(".value11").text("J");
                $(".value12").text("Q");
                $(".value13").text("K");
                $(".value14").text("A");
            }
        }

        $("#draw").on("click", function () {
            $("#draw").hide(3000);
            $("#draw").prop("disabled", true);
            var randomCard = deck[Math.floor(Math.random() * deck.length)];
            var randomCPUcard = deck2[Math.floor(Math.random() * deck2.length)];
            console.log(randomCard);
            console.log(randomCPUcard);
            compare.push(randomCard);
            compare.push(randomCPUcard);
            console.log(compare);
            compareHands();
            var dex = deck.indexOf(randomCard);
            var dexCPU = deck2.indexOf(randomCPUcard);
            console.log(dex);
            console.log(dexCPU);
            deck.splice(dex, 1);
            deck2.splice(dexCPU, 1);
            console.log(deck);
            console.log(deck2);
            renderDeck();
            renderDeck2();
            var cardValue = parseInt(Object.values(randomCard));
            var cpuValue = parseInt(Object.values(randomCPUcard));
            console.log(cardValue);
            console.log(cpuValue);

            if (cpuValue > cardValue) {
                setTimeout(function () {
                    $("#whoWins").show();
                    $("#whoWins").text("You Lose!!!");
                    $('#whoWins').animate({ fontSize: '90px' }, 1000);
                    $('#whoWins').animate({ fontSize: '0px' }, 1000);
                    $("#draw").show(3000);
                    $("#draw").prop("disabled", false);
                    $("#whoWins").fadeOut(1500);
                    $("#loser")[0].play();
                    cpuWins++;
                    $("#cpuWins").text(cpuWins);

                }, 3000);
                deck2.push(randomCPUcard);
                deck2.push(randomCard);
                compare.splice(0, 2);
                console.log(compare);
                storeDecks();
                renderDeck2();
            }


            if (cpuValue < cardValue) {
                setTimeout(function () {
                    $("#whoWins").show();
                    $("#whoWins").text("You Win!!!");
                    $('#whoWins').animate({ fontSize: '90px' }, 1000);
                    $('#whoWins').animate({ fontSize: '0px' }, 1000);
                    $("#draw").show(3000);
                    $("#draw").prop("disabled", false);
                    $("#whoWins").fadeOut(1500);
                    yourWins++;
                    $("#yourWins").text(yourWins);
                    $("#lewya")[0].play(5000);

                }, 3000);
                deck.push(randomCPUcard);
                deck.push(randomCard);
                compare.splice(0, 2);
                console.log(compare);
                storeDecks();
                renderDeck();
            }

            if (cpuValue === cardValue) {
                setTimeout(function () {
                    $("#whoWins").show(1500);
                    $("#whoWins").text("Stalemate!!!");
                    $('#whoWins').animate({ fontSize: '90px' }, 1500);
                    $('#whoWins').animate({ fontSize: '0px' }, 1500);
                    $("#draw").show(3000);
                    $("#draw").prop("disabled", false);
                    $("#whoWins").fadeOut(1500);

                }, 3000);
                var graveYard = [];
                graveYard.push(randomCard);
                graveYard.push(randomCPUcard);
                console.log(graveYard);
                compare.splice(0, 2);
                console.log(compare);
                renderDeck();
                renderDeck2();
                db.ref("/graveyard").update({
                    graveyard
                })
            }
        });

        function compareHands() {
            document.getElementById("compare").innerHTML = "";
            for (var i = 0; i < compare.length; i++) {
                var handCard = document.createElement("div");
                var handValue = document.createElement("div");
                var handSuit = document.createElement("div");
                handCard.className = "card";
                handValue.className = "value" + compare[i].Value + " " + compare[i].Suit;
                handSuit.className = "suit " + compare[i].Suit;
                handValue.innerHTML = compare[i].Value;
                handCard.appendChild(handValue);
                handCard.appendChild(handSuit);
                document.getElementById("compare").appendChild(handCard);
                $(".value11").text("J");
                $(".value12").text("Q");
                $(".value13").text("K");
                $(".value14").text("A");
            }
        }

        function storeDecks() {
            db.ref("/deck").update({
                deck
            })
            db.ref("/deck2").update({
                deck2
            })

        }

        function load() {
            deck = getDeck();
            deck2 = getDeck2();
            renderDeck();
            renderDeck2();
            console.log(deck);
            console.log(deck2);
            storeDecks();
            $("#whoWins").fadeOut();
        }
        window.onload = load;
    </script>

</body>

</html>